(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{373:function(a,t,s){"use strict";s.r(t);var r=s(6),e=Object(r.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"javaagent-应用指南"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javaagent-应用指南"}},[a._v("#")]),a._v(" JavaAgent 应用指南")]),a._v(" "),t("p",[a._v("Javaagent 是什么？")]),a._v(" "),t("p",[a._v("Javaagent 是 java 命令的一个参数。参数 javaagent 可以用于指定一个 jar 包，它利用 JVM 提供的 Instrumentation API 来更改加载 JVM 中的现有字节码。")]),a._v(" "),t("ol",[t("li",[a._v("这个 jar 包的 MANIFEST.MF 文件必须指定 Premain-Class 项。")]),a._v(" "),t("li",[a._v("Premain-Class 指定的那个类必须实现 premain() 方法。")])]),a._v(" "),t("p",[a._v("premain 方法，从字面上理解，就是运行在 main 函数之前的的类。当 Java 虚拟机启动时，在执行 main 函数之前，JVM 会先运行"),t("code",[a._v("-javaagent")]),a._v("所指定 jar 包内 Premain-Class 这个类的 premain 方法 。")]),a._v(" "),t("p",[a._v("在命令行输入 "),t("code",[a._v("java")]),a._v("可以看到相应的参数，其中有 和 java agent 相关的：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("-agentlib:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("libname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("选项"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\t\t\t  加载本机代理库 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("libname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(", 例如 -agentlib:hprof\n\t\t\t  另请参阅 -agentlib:jdwp"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("help 和 -agentlib:hprof"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("help\n-agentpath:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("pathname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("选项"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\t\t\t  按完整路径名加载本机代理库\n-javaagent:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("jarpath"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("选项"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\t\t\t  加载 Java 编程语言代理, 请参阅 java.lang.instrument\n")])])]),t("h2",{attrs:{id:"参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[a._v("#")]),a._v(" 参考资料")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.oracle.com/javase/7/docs/api/java/lang/instrument/package-summary.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("java.lang.instrument"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);